var lunrIndex,$results,pagesIndex;function getQueryVariable(e){for(var n=window.location.search.substring(1).split("&"),i=0;i<n.length;i++){var s=n[i].split("=");if(s[0]===e)return decodeURIComponent(s[1].replace(/\+/g,"%20"))}}var searchTerm=getQueryVariable("query");function initLunr(){$.getJSON("/index.json").done(function(e){pagesIndex=e,console.log("index:",pagesIndex),lunrIndex=lunr(function(){this.field("title",{boost:10}),this.field("tags",{boost:5}),this.field("image"),this.field("content"),this.ref("uri"),pagesIndex.forEach(function(e){this.add(e)},this)})}).fail(function(e,n,i){var s=n+", "+i;console.error("Error getting Hugo index flie:",s)})}function handle(e){13===e.keyCode&&e.preventDefault()}function initUI(){$news=$("main.main"),($results=$("main.results")).hide(),$("#search").keyup(function(){$news.hide(),$results.show();var e=$(this).val();if(e.length<2)return $news.show(),$results.hide(),void $news.removeClass("search");$results.empty(),$news.addClass("search"),renderResults(search(e))})}function search(e){return lunrIndex.search(e).map(function(e){return pagesIndex.filter(function(n){return n.uri===e.ref})[0]})}function renderResults(e){e.length&&($wrapblock=$('<div class="content"><div class="container"><div class="content-block"><div class="news-list"><div class="grid search-grid"></div></div></div></div></div>'),$("main.results").append($wrapblock),e.slice(0,100).forEach(function(e){var n=$('<div class="post">'),i=$('<article class="post-entry">'),s=$('<a class="image">'),r=$('<div class="post-info"><h3>');n.append(i.append(s),i.append(r)),r.find("h3").append($("<a>",{href:e.uri,text:e.title})),s.css("background","url("+e.image+") no-repeat 50% 50% / cover "),$(".search-grid").append(n)}))}initLunr(),$(document).ready(function(){initUI()});